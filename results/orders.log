2024-03-17 20:46:57.164 | INFO     | __main__:<module>:20 - Task 1. Structure of the table - [Row(keyspace_name='items', type='table', name='orders', create_statement="CREATE TABLE items.orders (\n    customer_name text,\n    order_date date,\n    order_price int,\n    items_ids list<int>,\n    PRIMARY KEY (customer_name, order_date)\n) WITH CLUSTERING ORDER BY (order_date ASC)\n    AND additional_write_policy = '99p'\n    AND bloom_filter_fp_chance = 0.01\n    AND caching = {'keys': 'ALL', 'rows_per_partition': 'NONE'}\n    AND cdc = false\n    AND comment = ''\n    AND compaction = {'class': 'org.apache.cassandra.db.compaction.SizeTieredCompactionStrategy', 'max_threshold': '32', 'min_threshold': '4'}\n    AND compression = {'chunk_length_in_kb': '16', 'class': 'org.apache.cassandra.io.compress.LZ4Compressor'}\n    AND memtable = 'default'\n    AND crc_check_chance = 1.0\n    AND default_time_to_live = 0\n    AND extensions = {}\n    AND gc_grace_seconds = 864000\n    AND max_index_interval = 2048\n    AND memtable_flush_period_in_ms = 0\n    AND min_index_interval = 128\n    AND read_repair = 'BLOCKING'\n    AND speculative_retry = '99p';"), Row(keyspace_name='items', type='index', name='items_ids_idx', create_statement='CREATE INDEX items_ids_idx ON items.orders (values(items_ids));')]
2024-03-17 20:46:57.166 | INFO     | __main__:<module>:24 - Task 2. All order of Valery Pupkin sorted by date - [Row(customer_name='Valery Pupkin', order_date=Date(11631), items_ids=[341823, 590560], order_price=474319994), Row(customer_name='Valery Pupkin', order_date=Date(11720), items_ids=[598177, 817748, 37699, 481875], order_price=807122247), Row(customer_name='Valery Pupkin', order_date=Date(12998), items_ids=[851925, 216572], order_price=30842282), Row(customer_name='Valery Pupkin', order_date=Date(13727), items_ids=[937946, 870486, 548031], order_price=34654383), Row(customer_name='Valery Pupkin', order_date=Date(14983), items_ids=[942188, 533671], order_price=953454816), Row(customer_name='Valery Pupkin', order_date=Date(16199), items_ids=[57216, 166002, 359711], order_price=759387102), Row(customer_name='Valery Pupkin', order_date=Date(16351), items_ids=[294684, 751397, 634997, 738141], order_price=419025371), Row(customer_name='Valery Pupkin', order_date=Date(17114), items_ids=[31043, 863312, 201663], order_price=47629222), Row(customer_name='Valery Pupkin', order_date=Date(19510), items_ids=[313413, 130584], order_price=230653511), Row(customer_name='Valery Pupkin', order_date=Date(19611), items_ids=[480881, 361079, 690360], order_price=664729487)]
2024-03-17 20:46:57.167 | INFO     | __main__:<module>:28 - Task 3. All orders of Valery Pupkin that have item with id 480881 - [Row(customer_name='Valery Pupkin', order_date=Date(19611), items_ids=[480881, 361079, 690360], order_price=664729487)]
2024-03-17 20:46:57.169 | INFO     | __main__:<module>:32 - Task 4.1 All rows for Valery Pupkin and date more than 2010-10-10 [Row(customer_name='Valery Pupkin', order_date=Date(14983), items_ids=[942188, 533671], order_price=953454816), Row(customer_name='Valery Pupkin', order_date=Date(16199), items_ids=[57216, 166002, 359711], order_price=759387102), Row(customer_name='Valery Pupkin', order_date=Date(16351), items_ids=[294684, 751397, 634997, 738141], order_price=419025371), Row(customer_name='Valery Pupkin', order_date=Date(17114), items_ids=[31043, 863312, 201663], order_price=47629222), Row(customer_name='Valery Pupkin', order_date=Date(19510), items_ids=[313413, 130584], order_price=230653511), Row(customer_name='Valery Pupkin', order_date=Date(19611), items_ids=[480881, 361079, 690360], order_price=664729487)]
2024-03-17 20:46:57.170 | INFO     | __main__:<module>:35 - Task 4.2 Number of rows for Valery Pupkin and date more than 2010-10-10 [Row(count=6)]
2024-03-17 20:46:57.171 | INFO     | __main__:<module>:39 - Task 5 Sum of every order of Valery Pupkin [Row(order_price=474319994), Row(order_price=807122247), Row(order_price=30842282), Row(order_price=34654383), Row(order_price=953454816), Row(order_price=759387102), Row(order_price=419025371), Row(order_price=47629222), Row(order_price=230653511), Row(order_price=664729487)]
2024-03-17 20:46:57.172 | INFO     | __main__:<module>:44 - Task 8. Writetime for all orders [Row(writetime_order_price=1710705662981705), Row(writetime_order_price=1710705662981705), Row(writetime_order_price=1710705662981705), Row(writetime_order_price=1710705662981705), Row(writetime_order_price=1710705662981705), Row(writetime_order_price=1710705662981705), Row(writetime_order_price=1710705662981705), Row(writetime_order_price=1710705662981705), Row(writetime_order_price=1710705662981705), Row(writetime_order_price=1710705662981705)]
2024-03-17 20:46:57.174 | INFO     | __main__:<module>:49 - Task 9 Creating row with some TTL []
